# 2025-09-17: Leptos SSR Integration & Workspace Architecture

## üéØ –ì–ª–∞–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- ‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª Leptos SSR —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º Rust backend
- ‚úÖ –°–æ–∑–¥–∞–ª workspace –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (backend + frontend + shared)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏–ª conditional compilation —Å feature flags
- ‚úÖ –†–µ—à–∏–ª WASM compatibility –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ **–ü–æ–ª—É—á–∏–ª –¥–∞–Ω–Ω—ã–µ –∏–∑ backend –Ω–∞ frontend —á–µ—Ä–µ–∑ server functions!**

## üß† –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–Ω—è–ª

### Workspaces - –∑–∞—á–µ–º –Ω—É–∂–Ω—ã?
**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ workspace:**
- Backend –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (sqlx, tokio, mio) –ø–æ–ø–∞–¥–∞—é—Ç –≤ WASM —Å–±–æ—Ä–∫—É
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ–¥ –º–µ–∂–¥—É native –∏ WASM targets

**–†–µ—à–µ–Ω–∏–µ —Å workspace:**
```
ADCO/
‚îú‚îÄ‚îÄ backend/     # —á–∏—Å—Ç—ã–π Rust —Å–µ—Ä–≤–µ—Ä (native)
‚îú‚îÄ‚îÄ frontend/    # Leptos + WASM
‚îî‚îÄ‚îÄ shared/      # –æ–±—â–∏–µ —Ç–∏–ø—ã (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ)
```

**Workspace –ø–æ–∑–≤–æ–ª—è–µ—Ç:**
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã –º–µ–∂–¥—É –∫—Ä–µ–π—Ç–∞–º–∏
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç WASM
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–µ—Ä—Å–∏—è–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Feature Flags - –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç?
**Conditional Compilation:**
```rust
#[cfg(feature = "backend")]
use sqlx::Type;

#[derive(Serialize, Deserialize)]
#[cfg_attr(feature = "backend", derive(sqlx::Type))]
pub struct Post { ... }
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- `#[cfg(feature = "backend")]` - –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Ñ–∏—á–∞ –≤–∫–ª—é—á–µ–Ω–∞
- `#[cfg_attr(...)]` - –∞—Ç—Ä–∏–±—É—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —É—Å–ª–æ–≤–Ω–æ
- –í WASM —Å–±–æ—Ä–∫–µ –Ω–µ—Ç —Ñ–∏—á–∏ "backend" ‚Üí –Ω–µ—Ç SQLx –∫–æ–¥–∞ ‚Üí –Ω–µ—Ç –æ—à–∏–±–æ–∫

**Dependencies with features:**
```toml
# shared/Cargo.toml
sqlx = { workspace = true, optional = true }

[features]
backend = ["dep:sqlx"]

# backend/Cargo.toml
adco-shared = { path = "../shared", features = ["backend"] }

# frontend/Cargo.toml
adco-shared = { path = "../shared" }  # –±–µ–∑ backend —Ñ–∏—á–∏!
```

## üöß –ü—Ä–æ–±–ª–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∏–ª

### 1. WASM Target Conflicts
**–û—à–∏–±–∫–∞:** `mio` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WASM target
**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–ª —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫—Ä–µ–π—Ç

### 2. UUID –≤ WASM
**–û—à–∏–±–∫–∞:** `uuid` —Ç—Ä–µ–±—É–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä–∞–Ω–¥–æ–º–Ω–æ—Å—Ç–∏ –¥–ª—è WASM
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª `"js"` —Ñ–∏—á—É –≤ workspace dependencies

### 3. SQLx Derives –≤ Shared Types
**–û—à–∏–±–∫–∞:** `#[derive(sqlx::Type)]` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ WASM
**–†–µ—à–µ–Ω–∏–µ:** Conditional derives —á–µ—Ä–µ–∑ `#[cfg_attr(feature = "backend", derive(...))]`

## üéì –ß—Ç–æ –∏–∑—É—á–∏–ª —Å–µ–≥–æ–¥–Ω—è

### Leptos Server Functions
- Server functions –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Å –∫–ª–∏–µ–Ω—Ç–∞
- –î–æ—Å—Ç—É–ø –∫ backend state —á–µ—Ä–µ–∑ dependency injection
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º

### Full-Stack Rust Architecture
- **Frontend:** Leptos + WASM (hydration)
- **Backend:** Axum + SQLx + LLM integrations
- **Shared:** –û–±—â–∏–µ —Ç–∏–ø—ã —Å conditional features
- **Integration:** Server functions –∫–∞–∫ bridge –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏

### Advanced Cargo Features
- Workspace dependencies coordination
- Optional dependencies management
- Feature-driven compilation
- Target-specific code paths

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–º–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSocket
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å LLM agents –≤ frontend workflow
- [ ] –î–æ–±–∞–≤–∏—Ç—å authentication –∏ authorization

## üìù –í—ã–≤–æ–¥—ã
–°–µ–≥–æ–¥–Ω—è –ø—Ä–æ—à—ë–ª —Å–µ—Ä—å–µ–∑–Ω—ã–π milestone - –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ backend –∫ full-stack Rust –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Å modern frontend!
Workspace + feature flags –æ–∫–∞–∑–∞–ª–∏—Å—å –∫–ª—é—á–µ–≤—ã–º–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è concerns –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –ª–æ–≥–∏–∫–æ–π.

**–ì–ª–∞–≤–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ:** –í Rust –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≥–¥–µ –æ–¥–∏–Ω –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ,
–Ω–æ –Ω—É–∂–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —á–µ—Ä–µ–∑ feature flags.